<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KIVOSY Make - Create Your Own App with AI</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q7K55RZKNW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-Q7K55RZKNW');
    </script>
    
    <!-- AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5981094525589755" crossorigin="anonymous"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Scripts (Modular) -->
    <script src="app-factory.js"></script>
    <script src="factory-ui.js"></script>
</head>
<body>
    <!-- í—¤ë” ë¶€ë¶„ë§Œ êµì²´ -->
<header class="make-header">
    <a href="index.html" class="make-logo">KIVOSY <span>Make</span></a>
    
    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav style="display: flex; gap: 24px; font-size: 15px; font-weight: 500; align-items: center;">
        <a href="index.html" style="color: #6366f1; text-decoration: none; font-weight: 700; padding: 6px 0; border-bottom: 3px solid #6366f1;">ğŸ  ë§Œë“¤ê¸°</a>
        <a href="gallery.html" style="color: #4b5563; text-decoration: none; padding: 6px 0;">ğŸ–¼ï¸ ê°¤ëŸ¬ë¦¬</a>
    </nav>

    <div style="display: flex; gap: 10px; align-items: center;">
        <!-- API ì‚¬ìš©ëŸ‰ í‘œì‹œ (lab.kivosy.com ìŠ¤íƒ€ì¼) -->
        <span style="background: #f1f5f9; padding: 6px 12px; border-radius: 20px; font-size: 13px; display: flex; align-items: center; gap: 4px;">
            <span>ğŸ“Š</span>
            <span>ì˜¤ëŠ˜ <strong id="daily-usage">0</strong>íšŒ</span>
        </span>
        
        <button onclick="showApiKeyModal()" style="background: #0d6efd; color: white; border: none; padding: 6px 12px; border-radius: 20px; font-size: 12px; cursor: pointer; display: flex; align-items: center; gap: 4px;">
            ğŸ”‘ API Key
        </button>
        
        <a href="https://buymeacoffee.com/anakist124" target="_blank" style="background: #FFDD00; color: #000; padding: 6px 12px; border-radius: 20px; text-decoration: none; font-size: 12px; display: flex; align-items: center; gap: 4px;">
            â˜• Buy me a coffee
        </a>
    </div>
</header>

    <!-- API í‚¤ ëª¨ë‹¬ -->
    <div id="api-key-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:10000;">
        <div style="background:white; max-width:400px; margin:100px auto; padding:30px; border-radius:16px;">
            <h3 style="margin-top:0;">ğŸ”‘ API Key ì„¤ì •</h3>
            <p style="font-size:13px; color:#606770;">Gemini ë˜ëŠ” Groq API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ë‘˜ ì¤‘ í•˜ë‚˜ë©´ OK)</p>
            
            <label style="display:block; margin:15px 0 5px; font-size:12px;">ğŸ¤– Gemini API Key</label>
            <input type="password" id="gemini-key" style="width:100%; padding:8px; border:1px solid #dee1e6; border-radius:8px;">
            
            <label style="display:block; margin:15px 0 5px; font-size:12px;">âš¡ Groq API Key</label>
            <input type="password" id="groq-key" style="width:100%; padding:8px; border:1px solid #dee1e6; border-radius:8px;">
            
            <div style="margin-top:20px; display:flex; gap:10px;">
                <button onclick="saveApiKeys()" style="flex:1; background:#0d6efd; color:white; border:none; padding:10px; border-radius:8px; cursor:pointer;">ì €ì¥</button>
                <button onclick="closeApiKeyModal()" style="flex:1; background:#f1f3f4; border:none; padding:10px; border-radius:8px; cursor:pointer;">ì·¨ì†Œ</button>
            </div>
        </div>
    </div>

    <!-- API í‚¤ ê´€ë ¨ í•¨ìˆ˜ (index.htmlì— ë‚¨ê¹€) -->
    <script>
    function showApiKeyModal() {
        document.getElementById('api-key-modal').style.display = 'block';
    }
    function closeApiKeyModal() {
        document.getElementById('api-key-modal').style.display = 'none';
    }
    function saveApiKeys() {
        const geminiKey = document.getElementById('gemini-key').value;
        const groqKey = document.getElementById('groq-key').value;
        if (geminiKey) localStorage.setItem('geminiApiKey', geminiKey);
        if (groqKey) localStorage.setItem('groqApiKey', groqKey);
        alert('API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');
        closeApiKeyModal();
    }
    </script>

    <!-- ë©”ì¸ ì»¨í…ì¸  (App Factory Tab) -->
    <div class="make-container">
        <div class="factory-wrapper">
            <!-- í—¤ë” -->
            <div class="factory-header">
                <div class="factory-logo">
                    <span class="factory-icon">ğŸ­</span>
                    <div>
                        <h2 class="factory-title">Conversation-to-App Factory</h2>
                        <p class="factory-subtitle">DeepSeek Officer Vision â€¢ Powered by KIVOSY Lab</p>
                    </div>
                </div>
                <div class="factory-quota">
                    <span id="quota-display">ì˜¤ëŠ˜ <strong id="quota-used">0</strong> / 10 ì•± ìƒì„±</span>
                    <div class="quota-bar"><div class="quota-fill" id="quota-fill"></div></div>
                </div>
            </div>

            <!-- ì…ë ¥ì°½ ìœ„ì— ì¶”ê°€ -->
            <div style="margin-bottom: 10px; display: flex; gap: 10px; align-items: center;">
                <select id="gemini-model-select" style="padding: 5px; border-radius: 6px;">
                    <option value="gemini-2.5-flash">Gemini 2.5 Flash (ë¹ ë¦„)</option>
                    <option value="gemini-1.5-pro">Gemini 1.5 Pro (ì •í™•)</option>
                </select>
                <select id="groq-model-select" style="padding: 5px; border-radius: 6px;">
                    <option value="llama-3.3-70b-versatile">Llama 3.3 70B</option>
                    <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
                </select>
            </div>

            <!-- ì…ë ¥ ì˜ì—­ -->
            <div class="factory-input-card">
                <label class="factory-label">ë¬´ì—‡ì„ ë§Œë“¤ê¹Œìš”?</label>
                <div class="factory-textarea-wrap">
                    <textarea
                        id="factory-prompt"
                        class="factory-textarea"
                        placeholder="ì˜ˆ: KTXì™€ SRT ê¸°ì°¨ ìš”ê¸ˆ ë¹„êµ ì•±ì„ ë§Œë“¤ì–´ì¤˜&#10;ì˜ˆ: ê°„ë‹¨í•œ í•  ì¼ ê´€ë¦¬(Todo) ì•±ì„ ë§Œë“¤ì–´ì¤˜&#10;ì˜ˆ: BMI ê³„ì‚°ê¸° ì•±ì„ ë§Œë“¤ì–´ì¤˜"
                        rows="4"
                    ></textarea>
                </div>
                <div class="factory-examples">
                    <span class="example-label">ë¹ ë¥¸ ì˜ˆì‹œ:</span>
                    <button class="example-chip" onclick="setFactoryPrompt('KTX, SRT ê¸°ì°¨í‘œ ê°€ê²© ë¹„êµ ì•±')">ğŸš„ ê¸°ì°¨í‘œ ë¹„êµ</button>
                    <button class="example-chip" onclick="setFactoryPrompt('í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸ ì•±')">â±ï¸ í¬ëª¨ë„ë¡œ íƒ€ì´ë¨¸</button>
                    <button class="example-chip" onclick="setFactoryPrompt('í™˜ìœ¨ ê³„ì‚°ê¸° (ì›í™”/ë‹¬ëŸ¬/ìœ ë¡œ/ì—”í™”)')">ğŸ’± í™˜ìœ¨ ê³„ì‚°ê¸°</button>
                    <button class="example-chip" onclick="setFactoryPrompt('í•œêµ­ì–´ ë§ì¶¤ë²• ì—°ìŠµ í€´ì¦ˆ ì•±')">ğŸ“ ë§ì¶¤ë²• í€´ì¦ˆ</button>
                    <button class="example-chip" onclick="setFactoryPrompt('ì¹¼ë¡œë¦¬ ê³„ì‚°ê¸° ë° ì‹ë‹¨ ê¸°ë¡ ì•±')">ğŸ¥— ì‹ë‹¨ ê¸°ë¡</button>
                </div>

                <button class="factory-generate-btn" id="factory-generate-btn" onclick="handleFactoryGenerate()">
                    <span id="factory-btn-text">âš¡ ì•± ìƒì„±í•˜ê¸°</span>
                    <div class="factory-spinner" id="factory-spinner" style="display:none;"></div>
                </button>
            </div>

            <!-- ì§„í–‰ ìƒíƒœ -->
            <div class="factory-progress" id="factory-progress" style="display:none;">
                <div class="progress-steps" id="progress-steps"></div>
            </div>

            <!-- ì˜¤ë¥˜ í‘œì‹œ -->
            <div class="factory-error" id="factory-error" style="display:none;"></div>

            <!-- ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° - ì±„íŒ… + ë¯¸ë¦¬ë³´ê¸° êµ¬ì¡°ë¡œ ë³€ê²½ -->
            <div class="factory-result" id="factory-result" style="display:none;">
                <div class="result-header">
                    <h3>âœ… ì•± ìƒì„± ì™„ë£Œ!</h3>
                    <div class="result-actions">
                        <button class="result-btn primary" id="result-open-btn" onclick="handleOpenApp()">ğŸš€ ìƒˆì°½ ì—´ê¸°</button>
                        <button class="result-btn secondary" id="result-copy-btn" onclick="handleCopyCode()">ğŸ“‹ ì½”ë“œ ë³µì‚¬</button>
                        <button class="result-btn danger" onclick="handleDeleteApp()">ğŸ—‘ï¸ ì‚­ì œ</button>
                    </div>
                </div>
                <div class="result-meta" id="result-meta"></div>
                
                <!-- ì±„íŒ… + ë¯¸ë¦¬ë³´ê¸° ìŠ¤í”Œë¦¿ ë·° -->
                <div class="split-layout" style="display: flex; height: 500px; border-top: 1px solid #dee1e6;">
                    <!-- ì¢Œì¸¡: ì±„íŒ…ì°½ -->
                    <div style="width: 35%; display: flex; flex-direction: column; background: #f9fafc; border-right: 1px solid #dee1e6;">
                        <div style="padding: 12px; background: #f1f3f4; border-bottom: 1px solid #dee1e6; font-size: 13px; font-weight: 600;">
                            ğŸ’¬ ì•± ìˆ˜ì • ì±„íŒ…
                        </div>
                        <div id="chat-messages" style="flex: 1; overflow-y: auto; padding: 12px; display: flex; flex-direction: column; gap: 8px;">
                            <!-- ì±„íŒ… ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
                            <div class="chat-message system" style="background: #e8f0fe; padding: 8px 12px; border-radius: 12px; font-size: 13px; color: #1a1a1a; align-self: flex-start; max-width: 85%;">
                                ì•±ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ìˆ˜ì •í•  ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.
                            </div>
                        </div>
                        <div style="padding: 12px; border-top: 1px solid #dee1e6; background: white;">
                            <div style="display: flex; gap: 8px;">
                                <textarea 
                                    id="chat-input" 
                                    placeholder="ì˜ˆ: ë²„íŠ¼ ìƒ‰ìƒì„ íŒŒë€ìƒ‰ìœ¼ë¡œ ë°”ê¿”ì¤˜" 
                                    style="flex: 1; padding: 8px; border: 1px solid #dee1e6; border-radius: 8px; font-size: 13px; resize: none; height: 40px;"
                                    onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); sendChat(); }"
                                ></textarea>
                                <button 
                                    onclick="sendChat()" 
                                    style="background: #6366f1; color: white; border: none; border-radius: 8px; padding: 0 16px; font-size: 13px; cursor: pointer;"
                                >ì „ì†¡</button>
                            </div>
                            <div style="margin-top: 6px; font-size: 11px; color: #888; text-align: right;">
                                â Enter ì „ì†¡
                            </div>
                        </div>
                    </div>
                    
                    <!-- ìš°ì¸¡: ì•± ë¯¸ë¦¬ë³´ê¸° -->
                    <div style="width: 65%; display: flex; flex-direction: column; background: white;">
                        <div style="padding: 8px 12px; background: #f1f3f4; border-bottom: 1px solid #dee1e6; font-size: 12px; color: #555; display: flex; justify-content: space-between;">
                            <span>ğŸ” ì•± ë¯¸ë¦¬ë³´ê¸°</span>
                            <span style="display: flex; gap: 8px;">
                                <button onclick="refreshPreview()" style="background: none; border: none; cursor: pointer; color: #6366f1;">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                                <button onclick="togglePreviewSize()" style="background: none; border: none; cursor: pointer; color: #6366f1;">â›¶ ì „ì²´í™”ë©´</button>
                            </span>
                        </div>
                        <div style="flex: 1; overflow: hidden; background: white;">
                            <iframe 
                                id="result-preview" 
                                class="result-preview" 
                                sandbox="allow-scripts allow-same-origin"
                                style="width: 100%; height: 100%; border: none;"
                            ></iframe>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìƒì„±ëœ ì•± ëª©ë¡ -->
            <div class="factory-history">
                <div class="history-header">
                    <h3>ğŸ“¦ ìƒì„±ëœ ì•± ëª©ë¡</h3>
                    <button class="history-refresh" onclick="renderAppHistory()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
                </div>
                <div id="app-history-list" class="history-list"></div>
            </div>
        </div>
    </div>

    <!-- í‘¸í„° -->
    <footer class="footer">
        <div>âš¡ Made with <a href="https://kivosy.com" target="_blank" style="color:#0d6efd; text-decoration:none;">KIVOSY Labs</a> | Make your own app</div>
        <div style="margin-top: 8px; font-size: 11px;">
            <a href="#" onclick="alert('API keys are stored only in your browser. No data sent to our servers.')" style="color:#606770;">ğŸ”’ Privacy</a>
            &nbsp;|&nbsp;
            <a href="#" onclick="alert('Free to use with your own API keys. 10 apps per day.')" style="color:#606770;">ğŸ“‹ Terms</a>
        </div>
    </footer>
</body>
</html>